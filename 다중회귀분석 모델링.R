-버스정류장 위치 선정을 위한 최종 모델링 코드(회귀 식 생성)
head(dat1)
quantile(dat1$대기오염노출,0)
quantile(dat1$대기오염노출,0.25)
quantile(dat1$대기오염노출,0.5)
quantile(dat1$대기오염노출,0.75)
dat1$대기오염노출지수=ifelse(dat1$대기오염노출<25735,0,
                     ifelse(dat1$대기오염노출<69942.27,1,ifelse(dat1$대기오염노출<=208773.6,2,3)))
write.csv(dat1,"new.csv")
data2=read.csv("new.csv",header=T)
head(data2)
model1=lm(총점~총승객수+대기오염노출+버스정류장별예상매연점수,data=data5)
model1=step(model1)
model1=lm(총점~대기오염노출+버스정류장별예상매연점수,data=data5)
summary(model1)
par(mfrow=c(2,2))
plot(model1)
ncol(data2)
data5=data2[,c(2,3,4,10,14,20,22)]
head(data5)
data5[,4]=scale(data5[,4])
data5[,5]=scale(data5[,5])
data5[,6]=scale(data5[,6])

head(data5)
write.csv(data5,"제발.csv")
data5$최종점수=4.4824+(1.0721*data5[,5])+(0.9355*data5[,6])
head(data5)
write.csv(data5,"제발좀.csv")

머지=read.csv("멀지.csv",header=T)
head(머지)
최종=merge(data5,머지,by='정류소명')
write.csv(최종,"끝.csv")
